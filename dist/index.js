var r,e,t=require("@apollo/client/core");function n(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,i(r,e)}function o(r){return o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},o(r)}function i(r,e){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,e){return r.__proto__=e,r},i(r,e)}function a(r,e,t){return a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(r){return!1}}()?Reflect.construct.bind():function(r,e,t){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(r,n));return t&&i(o,t.prototype),o},a.apply(null,arguments)}function u(r){var e="function"==typeof Map?new Map:void 0;return u=function(r){if(null===r||-1===Function.toString.call(r).indexOf("[native code]"))return r;if("function"!=typeof r)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(r))return e.get(r);e.set(r,t)}function t(){return a(r,arguments,o(this).constructor)}return t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,r)},u(r)}function c(r,e){return e||(e=r.slice(0)),r.raw=e,r}var s={arweave:"",center:"https://graph-api.bi.social/graphql"},d=/*#__PURE__*/function(r){function e(e){var t;return(t=r.call(this,e)||this).name="NetworkError",t}return n(e,r),e}(/*#__PURE__*/u(Error)),f=/*#__PURE__*/function(r){function e(e){var t;return(t=r.call(this,e)||this).name="RateLimitError",t}return n(e,r),e}(/*#__PURE__*/u(Error)),l=/*#__PURE__*/function(r){function e(e){var t;return(t=r.call(this,e)||this).name="BadQueryError",t}return n(e,r),e}(/*#__PURE__*/u(Error)),p=/*#__PURE__*/function(r){function e(e){var t;return(t=r.call(this,e)||this).name="BadAuthError",t}return n(e,r),e}(/*#__PURE__*/u(Error)),y=/*#__PURE__*/function(){function n(r){this.source=void 0,this.graphqlClient=void 0;var e=r.key,n=r.secret;this.source=r.source||"center",this.graphqlClient=new t.ApolloClient({headers:{key:e,secret:n},uri:r.uri||s[this.source],cache:new t.InMemoryCache})}var o=n.prototype;return o.queryDidEntity=function(r){try{var e=this;if(!r.didName&&!r.address)throw new l("Need to specify at least one query parameter: didName, address");return Promise.resolve("center"===e.source?e.queryDidCenterServer(r):e.queryArweave(r))}catch(r){return Promise.reject(r)}},o.queryDidCenterServer=function(e){try{var n=this,o=t.gql(r||(r=c(["\n      query DidEntity($didName: String, $address: String) {\n        didEntity(didName: $didName, address: $address) {\n          didName\n          address\n          avatar\n        }\n      }\n    "])));return Promise.resolve(function(r,t){try{var i=Promise.resolve(n.graphqlClient.query({query:o,variables:e})).then(function(r){var e=r.data.didEntity;return{didName:e.didName,address:e.address,avatar:e.avatar}})}catch(r){return t(r)}return i&&i.then?i.then(void 0,t):i}(0,function(r){throw"fetch failed"===r.message?new d(r):r.message.startsWith("Too many requests, please try again")?new f(r):"BAD_KEY_OR_SECRET"===r.message?new p(r):"INVALID_ARGUMENTS"===r.message?new l(r):r}))}catch(r){return Promise.reject(r)}},o.queryArweave=function(r){try{var n=t.gql(e||(e=c([""])));return Promise.resolve(this.graphqlClient.query({query:n})).then(function(r){var e=r.data.didEntity;return{didName:e.didName,address:e.address,avatar:e.avatar}})}catch(r){return Promise.reject(r)}},n}();exports.BadAuthError=p,exports.BadQueryError=l,exports.DidClient=y,exports.NetworkError=d,exports.RateLimitError=f;
//# sourceMappingURL=index.js.map
